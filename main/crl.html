<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Contextual RL Environments in Mighty &#8212; Mighty Documentation 0.0.1 documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ac9c05f7c49ca1e1f876c6e36360ea26.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=2eb4fb78" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    
  <link rel="preload" as="script" href="_static/js/index.9ea38e314b9e6d9dab77.js">

    <script src="_static/documentation_options.js?v=f539c95a"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dynamic Algorithm Configuration with Mighty" href="dac.html" />
    <link rel="prev" title="Mighty on Standard Gym Environments" href="basics.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
  <a class="navbar-brand" href="index.html">
  <!-- <p class="title">Mighty Documentation</p> -->
  </a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/automl/Mighty" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/automl_org?lang=de" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown mt-1">
    <button type="button" class="btn btn-secondary btn-md navbar-btn dropdown-toggle" id="dLabelMore"
        data-toggle="dropdown">
        v0.0.1
        <span class="caret"></span>
    </button>
    <div class="dropdown-menu list-group-flush py-0" aria-labelledby="dLabelMore">
        <a class="list-group-item list-group-item-action" href="#">v0.0.1</a>
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search align-items-center" action="search.html" method="get" style="width: 100%;">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control btn btn-md" name="q" id="search-input"
    placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><h4 class="mt-0 mb-0"><a href="index.html">Mighty Documentation</a></h4>
<div class="mb-3">v0.0.1</div><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basics.html">
   Mighty on Standard Gym Environments
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Contextual RL Environments in Mighty
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dac.html">
   Dynamic Algorithm Configuration with Mighty
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api.html">
   API References
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="api/mighty.html">
     mighty
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="api/mighty.mighty_agents.html">
       mighty.mighty_agents
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_agents.base_agent.html">
         mighty.mighty_agents.base_agent
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_agents.dqn.html">
         mighty.mighty_agents.dqn
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_agents.factory.html">
         mighty.mighty_agents.factory
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_agents.ppo.html">
         mighty.mighty_agents.ppo
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_agents.sac.html">
         mighty.mighty_agents.sac
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="api/mighty.mighty_exploration.html">
       mighty.mighty_exploration
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_exploration.epsilon_greedy.html">
         mighty.mighty_exploration.epsilon_greedy
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_exploration.ez_greedy.html">
         mighty.mighty_exploration.ez_greedy
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_exploration.mighty_exploration_policy.html">
         mighty.mighty_exploration.mighty_exploration_policy
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_exploration.stochastic_policy.html">
         mighty.mighty_exploration.stochastic_policy
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="api/mighty.mighty_meta.html">
       mighty.mighty_meta
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
      <label for="toctree-checkbox-5">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_meta.cosine_lr_schedule.html">
         mighty.mighty_meta.cosine_lr_schedule
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_meta.mighty_component.html">
         mighty.mighty_meta.mighty_component
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_meta.plr.html">
         mighty.mighty_meta.plr
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_meta.space.html">
         mighty.mighty_meta.space
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="api/mighty.mighty_models.html">
       mighty.mighty_models
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_models.dqn.html">
         mighty.mighty_models.dqn
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_models.networks.html">
         mighty.mighty_models.networks
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_models.ppo.html">
         mighty.mighty_models.ppo
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_models.sac.html">
         mighty.mighty_models.sac
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="api/mighty.mighty_replay.html">
       mighty.mighty_replay
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_replay.buffer.html">
         mighty.mighty_replay.buffer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_replay.mighty_replay_buffer.html">
         mighty.mighty_replay.mighty_replay_buffer
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_replay.mighty_rollout_buffer.html">
         mighty.mighty_replay.mighty_rollout_buffer
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="api/mighty.mighty_runners.html">
       mighty.mighty_runners
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_runners.factory.html">
         mighty.mighty_runners.factory
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_runners.mighty_es_runner.html">
         mighty.mighty_runners.mighty_es_runner
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_runners.mighty_maml_runner.html">
         mighty.mighty_runners.mighty_maml_runner
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_runners.mighty_online_runner.html">
         mighty.mighty_runners.mighty_online_runner
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_runners.mighty_runner.html">
         mighty.mighty_runners.mighty_runner
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="api/mighty.mighty_update.html">
       mighty.mighty_update
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
      <label for="toctree-checkbox-9">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_update.ppo_update.html">
         mighty.mighty_update.ppo_update
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_update.q_learning.html">
         mighty.mighty_update.q_learning
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="api/mighty.mighty_update.sac_update.html">
         mighty.mighty_update.sac_update
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="api/mighty.run_mighty.html">
       mighty.run_mighty
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cite.html">
   Cite Us
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="contextual-rl-environments-in-mighty">
<h1>Contextual RL Environments in Mighty<a class="headerlink" href="#contextual-rl-environments-in-mighty" title="Link to this heading">Â¶</a></h1>
<p>Most RL environments are either not concerned with generalization at all or test generalization performance without providing much insight into what agents are tested on,
e.g. by using procedurally generated levels that are hard to understand as a structured training or test distribution.
Contextual RL (or cRL)[<a class="reference external" href="https://arxiv.org/pdf/1502.02259.pdf">Hallak et al., CoRR 2015</a>, <a class="reference external" href="https://arxiv.org/pdf/2202.04500.pdf">Benjamins et al., CoRR 2022</a>] aims to make the task distributions agents are trained on a specific as possible in order to gain better insights where agents perform well and
what is currently missing in RL generalization.</p>
<p><a class="reference external" href="https://github.com/automl/CARL">CARL (context adaptive RL)</a> [<a class="reference external" href="https://arxiv.org/pdf/2110.02102.pdf">Benjamins et al., EcoRL 2021</a>] is a benchmark library specifically designed for contextual RL.
It provides highly configurable contextual extensions to several well-known RL environments and is what we recommend to get started in cRL.
Mighty is designed with contextual RL in mind and therefore fully compatible with CARL.
Before you start training, however, please follow the installation instructions in the <a class="reference external" href="https://github.com/automl/CARL">CARL repo</a>.</p>
<p>Then use the same command as before, but provide the CARL environment, in this example CARLCartPoleEnv,
and information about the context distribution as keywords:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>mighty/run_mighty.py<span class="w"> </span><span class="s1">&#39;algorithm=dqn&#39;</span><span class="w"> </span><span class="s1">&#39;env=CARLCartPoleEnv&#39;</span><span class="w"> </span><span class="s1">&#39;+env_kwargs.num_contexts=10&#39;</span><span class="w"> </span><span class="s1">&#39;+env_kwargs.context_feature_args=[gravity]&#39;</span>
</pre></div>
</div>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="basics.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mighty on Standard Gym Environments</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="dac.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dynamic Algorithm Configuration with Mighty</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="_static/js/index.9ea38e314b9e6d9dab77.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright Copyright 2024, AutoML.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a>
8.0.2. Template is modified version of <a
href="https://pydata-sphinx-theme.readthedocs.io">PyData Sphinx Theme</a>. <br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>